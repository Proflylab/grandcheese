using Dapper;
using GrandCheese.Util;
using GrandCheese.Util.Extensions;
using GrandCheese.Util.Models;
using GrandCheese.Util.Types;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace GrandCheese
{
    class Login
    {
        [OpcodeAttribute((short)LoginOpcodes.HEART_BIT_NOT)]
        public static void HandleHeartbeat(Client client, Packet packet)
        {
            client.LastHeartbeat = DateTime.Now;
        }

        [OpcodeAttribute((short)LoginOpcodes.ENU_CLIENT_CONTENTS_FIRST_INIT_INFO_REQ)]
        public static void SendClientContentsFirstInitInfo(Client client, Packet packet)
        {
            Packet p = new Packet((short)LoginOpcodes.ENU_CLIENT_CONTENTS_FIRST_INIT_INFO_ACK);
            p.WriteHexString("00 00 00 00 00 00 00 05 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 16 4C 00 6F 00 61 00 64 00 31 00 5F 00 31 00 2E 00 64 00 64 00 73 00 00 00 00 16 4C 00 6F 00 61 00 64 00 31 00 5F 00 32 00 2E 00 64 00 64 00 73 00 00 00 00 16 4C 00 6F 00 61 00 64 00 31 00 5F 00 33 00 2E 00 64 00 64 00 73 00 00 00 00 1A 4C 00 6F 00 61 00 64 00 47 00 61 00 75 00 67 00 65 00 2E 00 64 00 64 00 73 00 00 00 00 02 00 00 00 00 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 03 00 00 00 24 75 00 69 00 5F 00 6D 00 61 00 74 00 63 00 68 00 5F 00 6C 00 6F 00 61 00 64 00 31 00 2E 00 64 00 64 00 73 00 00 00 00 24 75 00 69 00 5F 00 6D 00 61 00 74 00 63 00 68 00 5F 00 6C 00 6F 00 61 00 64 00 32 00 2E 00 64 00 64 00 73 00 00 00 00 24 75 00 69 00 5F 00 6D 00 61 00 74 00 63 00 68 00 5F 00 6C 00 6F 00 61 00 64 00 33 00 2E 00 64 00 64 00 73 00 00 00 00 00 00 00 00 03 00 00 00 00 00 00 00 14 53 00 71 00 75 00 61 00 72 00 65 00 2E 00 6C 00 75 00 61 00 00 00 00 01 00 00 00 20 53 00 71 00 75 00 61 00 72 00 65 00 4F 00 62 00 6A 00 65 00 63 00 74 00 2E 00 6C 00 75 00 61 00 00 00 00 02 00 00 00 24 53 00 71 00 75 00 61 00 72 00 65 00 33 00 44 00 4F 00 62 00 6A 00 65 00 63 00 74 00 2E 00 6C 00 75 00 61 00 00 00 00 03 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 00 00 00 00 0B 00 00 00 18 47 00 43 00 4D 00 61 00 73 00 74 00 65 00 72 00 2E 00 64 00 6C 00 6C 00 00 00 00 1E 47 00 43 00 4D 00 61 00 73 00 74 00 65 00 72 00 55 00 53 00 41 00 2E 00 64 00 6C 00 6C 00 00 00 00 20 47 00 43 00 54 00 72 00 61 00 69 00 6E 00 65 00 72 00 44 00 6C 00 6C 00 2E 00 64 00 6C 00 6C 00 00 00 00 1E 47 00 72 00 61 00 6E 00 64 00 43 00 68 00 61 00 73 00 65 00 4C 00 2E 00 64 00 6C 00 6C 00 00 00 00 20 4D 00 61 00 63 00 68 00 69 00 6E 00 65 00 43 00 6F 00 72 00 65 00 32 00 2E 00 64 00 6C 00 6C 00 00 00 00 18 50 00 65 00 6E 00 65 00 4C 00 6F 00 63 00 6F 00 2E 00 64 00 6C 00 6C 00 00 00 00 16 50 00 69 00 63 00 68 00 75 00 6C 00 61 00 2E 00 64 00 6C 00 6C 00 00 00 00 18 50 00 69 00 63 00 68 00 75 00 6C 00 6F 00 6E 00 2E 00 64 00 6C 00 6C 00 00 00 00 12 6D 00 61 00 69 00 6E 00 32 00 2E 00 64 00 6C 00 6C 00 00 00 00 18 6D 00 61 00 6D 00 61 00 77 00 65 00 76 00 6F 00 2E 00 64 00 6C 00 6C 00 00 00 00 14 70 00 65 00 72 00 72 00 6F 00 32 00 2E 00 64 00 6C 00 6C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00");
            client.SendPacket(p);
        }

        [OpcodeAttribute((short)LoginOpcodes.ENU_SHAFILENAME_LIST_REQ)]
        public static void SendShaFileList(Client client, Packet packet)
        {
            Packet p = new Packet((short)LoginOpcodes.ENU_SHAFILENAME_LIST_ACK);

            p.WriteInt(0);

            string[] shaFiles = new string[] { "ai.kom", "fan_map.kom" };
            p.WriteInt(shaFiles.Length);

            for (int i = 0; i < shaFiles.Length; i++)
            {
                var shaFile = shaFiles[i];
                p.WriteInt(shaFile.Length * 2);
                p.WriteUnicodeString(shaFile);
            }

            client.SendPacket(p);
        }

        [OpcodeAttribute((short)LoginOpcodes.ENU_VERIFY_ACCOUNT_REQ)]
        public static void VerifyAccount(Client client, Packet packet)
        {
            packet.ReadInt(); // trash data

            int lenId = packet.ReadInt();
            String id = packet.ReadString(lenId);
            int lenPw = packet.ReadInt();
            String pw = packet.ReadString(lenPw);

            // TODO: use bcrypt.net
            using (var db = Database.Get())
            {
                var user = db.Query<User>("SELECT * FROM users WHERE username = @name",
                    new { name = id }).FirstOrDefault();

                if(user != null)
                {
                    if (pw == user.Password)
                    {
                        Log.Get().Info("{0} logged in.", user.Username);
                        
                        var serverList = new Packet((short)LoginOpcodes.ENU_SERVER_LIST_NOT);
                        serverList.WriteInt(Data.Servers.Count);
                        int i = 1;
                        foreach(var server in Data.Servers)
                        {
                            serverList.Put(
                                i,
                                i,
                                server.Name.ToWideString(),
                                server.IP,
                                (short)server.Port,
                                server.OnlineUsers,
                                server.MaxUsers,
                                server.ProtocolVersion,
                                new GCPair(-1, -1), // RangeMinMaxLevel
                                server.IP,
                                server.Description.ToWideString(),
                                0 // MaxLevel
                            );

                            i++;
                        }

                        client.SendPacket(serverList);

                        SendChannelNews(client, packet);
                        SendItemBuyInfo(client, packet);
                        SendClientOpenContents(client, packet);
                        SendSocketTableInfo(client, packet);
                        SendCashbackRatioInfo(client, packet);

                        var success = new Packet((short)LoginOpcodes.ENU_VERIFY_ACCOUNT_ACK);

                        success.Put(
                            0,
                            id.ToWideString(),
                            pw,
                            0
                        );

                        success.WriteHexString("14 0F 03 F7 4C 00 00 00 00");

                        success.WriteString("US", true); // Country code

                        success.WriteHexString("00 00 C9 8E 00 00 C9 8E");
                        
                        success.WriteUnicodeString(id, true);

                        if (user.Nickname == null)
                        {
                            success.WriteInt(0); // try without
                        }
                        else
                        {
                            success.WriteInt(user.Nickname.Length * 2);
                            success.WriteUnicodeString(user.Nickname);
                        }

                        success.WriteHexString("00 00 00 04 01 00");
                        
                        int guild_contribution = 10000;
                        success.WriteInt(guild_contribution);
                        success.WriteHexString("00 00 00 00 00 00 00 00");

                        // 길드 자기소개
                        string guild_whoami = "I am lovemomory.";
                        success.WriteInt(guild_whoami.Length * 2);
                        success.WriteUnicodeString(guild_whoami);

                        // ...
                        success.WriteHexString("07 E1 06 12 00 00 00 07 E1 07 09 00 00 00 00 00 00 00 00 00 04");

                        // 길드 이름
                        string guild_name = "플레이지씨컴";
                        success.WriteInt(guild_name.Length * 2);
                        success.WriteUnicodeString(guild_name);

                        success.WriteHexString("01 00 00 00 01");

                        // 길드마크 아마도..
                        string guild_mark = "4_1.png";
                        success.WriteInt(guild_mark.Length * 2);
                        success.WriteUnicodeString(guild_mark);

                        // 길드 설명
                        string guild_desc = "공식 플지컴 길드!\nOfficial Play GC.Kom Guild\n";
                        success.WriteInt(guild_desc.Length * 2);
                        success.WriteUnicodeString(guild_desc);

                        // ...
                        success.WriteHexString("02 07 E1 05 15 00 00 00 00 02 E0 C2");

                        // Guild URL
                        string guild_url = "http://play.gckom.com";
                        success.WriteInt(guild_url.Length * 2);
                        success.WriteUnicodeString(guild_url);
                        
                        success.WriteInt(0); // ?
                        success.WriteInt(500000); // Guild EXP

                        success.WriteHexString("00 00 00 C7 00 00 00 00 00 00 00 00 00 00 00 00 03 00 00 03 E8 00 00 00 03");

                        // 길드 설명이 또;;
                        success.WriteInt(1);
                        success.WriteInt(guild_desc.Length * 2);
                        success.WriteUnicodeString(guild_desc);

                        // 길드 공지1
                        String guild_notice1 = "test1";
                        String guild_notice2 = "test2";
                        success.WriteInt(2);
                        success.WriteInt(guild_notice1.Length * 2);
                        success.WriteUnicodeString(guild_notice1);

                        success.WriteInt(3);
                        success.WriteInt(guild_notice2.Length * 2);
                        success.WriteUnicodeString(guild_notice2);

                        success.WriteInt(0);

                        String guildMarkUrl = "http://play.gckom.com/guildmark/";
                        success.WriteInt(guildMarkUrl.Length * 2);
                        success.WriteUnicodeString(guildMarkUrl);

                        success.WriteHexString("00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 07 00 00 00 00 00 0C 1A C6 8E 02 00 00 00 00 0C 1A C6 8E 08 00 00 00 00 0C 1A C6 8E 09 00 00 00 00 0C 1A C6 8E 10 00 00 00 00 00 00 09 D3 11 00 00 00 00 0C 1A C6 8E 12 00 00 00 00 00 00 02 21 01 BF 80 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00");
                        
                        client.SendPacket(success, true);

                        return;
                    }
                }
            }

            Packet pLoginfail = new Packet((short)LoginOpcodes.ENU_VERIFY_ACCOUNT_ACK);

            pLoginfail.Put(
                20, // login failure
                id.ToWideString(), // user ID
                0 // what's this
            );

            client.SendPacket(pLoginfail, true);

            Log.Get().Info("Login failed for {0}", id);
        }
        
        public static void SendClientOpenContents(Client client, Packet packet)
        {
            Packet p = new Packet((short)LoginOpcodes.ENU_NEW_CLIENT_CONTENTS_OPEN_NOT);
            
            // Season 5
            p.WriteHexString("00 00 00 00 00 00 00 03 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 0C 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 02 00 00 00 01 00 00 00 03 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 08 00 00 00 08 00 00 00 01 00 00 00 09 00 00 00 15 00 00 00 01 00 00 00 0D 00 00 00 09 00 00 00 01 00 00 00 01 00 00 00 0A 00 00 00 01 00 00 00 01 00 00 00 0E 00 00 00 01 00 00 00 01 00 00 00 12 00 00 00 01 00 00 00 01 00 00 00 14 00 00 00 01 00 00 00 01 00 00 00 16 00 00 00 01 00 00 00 0E 00 00 00 0B 00 00 00 00 00 00 00 02 00 00 00 01 00 00 00 02 00 00 00 01 00 00 00 01 00 00 00 05 00 00 00 03 00 00 00 01 00 00 00 06 00 00 00 04 00 00 00 01 00 00 00 00 00 00 00 05 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 07 00 00 00 01 00 00 00 1D 00 00 00 08 00 00 00 02 00 00 00 1F 00 00 00 20 00 00 00 02 00 00 00 46 00 00 00 07 00 00 00 08 00 00 00 09 00 00 00 0A 00 00 00 0B 00 00 00 0C 00 00 00 0D 00 00 00 0E 00 00 00 0F 00 00 00 10 00 00 00 11 00 00 00 12 00 00 00 13 00 00 00 14 00 00 00 15 00 00 00 16 00 00 00 17 00 00 00 18 00 00 00 19 00 00 00 1A 00 00 00 1B 00 00 00 1E 00 00 00 24 00 00 00 27 00 00 00 28 00 00 00 29 00 00 00 2A 00 00 00 2B 00 00 00 2C 00 00 00 2F 00 00 00 2D 00 00 00 2E 00 00 00 30 00 00 00 31 00 00 00 32 00 00 00 37 00 00 00 38 00 00 00 39 00 00 00 3A 00 00 00 3B 00 00 00 3C 00 00 00 3D 00 00 00 3E 00 00 00 3F 00 00 00 40 00 00 00 45 00 00 00 46 00 00 00 49 00 00 00 4A 00 00 00 4C 00 00 00 4E 00 00 00 4F 00 00 00 50 00 00 00 51 00 00 00 54 00 00 00 55 00 00 00 56 00 00 00 57 00 00 00 58 00 00 00 59 00 00 00 5A 00 00 00 5B 00 00 00 5C 00 00 00 5D 00 00 00 5E 00 00 00 5F 00 00 00 62 00 00 00 63 00 00 00 64 00 00 00 65 00 00 00 09 00 00 00 02 00 00 00 21 00 00 00 22 00 00 00 0D 00 00 00 01 00 00 00 42 00 00 00 0E 00 00 00 01 00 00 00 4D 00 00 00 0C 00 00 00 04 00 00 00 00 01 00 00 00 00 00 00 00 00 01 00 00 00 10 00 00 00 03 00 00 00 00 00 00 00 63 00 00 00 0A 00 00 00 08 00 00 00 64 00 00 00 02 00 00 00 07 00 00 00 04 00 00 00 05 00 00 00 01 00 00 00 06 00 00 00 0B 00 00 00 09 00 00 00 2B 00 00 00 2F 00 00 00 01 01 00 00 00 0C 00 00 00 0A 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 09 00 00 00 04 00 00 00 06 00 00 00 05 00 00 00 08 00 00 00 07 00 00 00 0B 00 00 00 05 01 00 00 00 10 00 00 00 63 00 00 00 64 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 05 00 00 00 06 00 00 00 07 00 00 00 08 00 00 00 09 00 00 00 0A 00 00 00 0B 00 00 00 2B 00 00 00 2F 00 00 00 03 01 00 00 00 06 00 00 00 00 00 00 00 01 00 00 00 09 00 00 00 0B 00 00 00 02 00 00 00 0A 00 00 00 08 01 00 00 00 0F 00 00 00 03 00 00 00 00 00 00 00 63 00 00 00 0A 00 00 00 08 00 00 00 64 00 00 00 02 00 00 00 07 00 00 00 04 00 00 00 01 00 00 00 06 00 00 00 0B 00 00 00 09 00 00 00 2B 00 00 00 2F 00 00 00 0B 00 00 00 00 0D 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 06 00 00 00 07 00 00 00 08 00 00 00 09 00 00 00 0A 00 00 00 0B 00 00 00 2B 00 00 00 2F 00 00 00 0A 00 00 00 00 02 00 00 00 00 00 00 00 0A 00 00 00 06 00 00 00 00 01 00 00 00 00 00 00 00 0C 00 00 00 00 01 00 00 00 00 00 00 00 0E 01 00 00 00 05 00 00 00 63 00 00 00 00 00 00 00 03 00 00 00 08 00 00 00 0A 00 00 00 0F 01 00 00 00 10 00 00 00 03 00 00 00 00 00 00 00 63 00 00 00 0A 00 00 00 08 00 00 00 64 00 00 00 02 00 00 00 07 00 00 00 04 00 00 00 05 00 00 00 01 00 00 00 06 00 00 00 0B 00 00 00 09 00 00 00 2B 00 00 00 2F 00 00 00 06 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 05 00 00 00 55 00 00 00 14 00 00 00 00 00 00 00 04 00 01 02 03 00 00 00 01 00 00 00 04 00 01 02 03 00 00 00 02 00 00 00 04 00 01 02 03 00 00 00 03 00 00 00 04 00 01 02 03 00 00 00 04 00 00 00 04 00 01 02 03 00 00 00 05 00 00 00 04 00 01 02 03 00 00 00 06 00 00 00 04 00 01 02 03 00 00 00 07 00 00 00 04 00 01 02 03 00 00 00 08 00 00 00 04 00 01 02 03 00 00 00 09 00 00 00 04 00 01 02 03 00 00 00 0A 00 00 00 04 00 01 02 03 00 00 00 0B 00 00 00 04 00 01 02 03 00 00 00 0C 00 00 00 04 00 01 02 03 00 00 00 0D 00 00 00 04 00 01 02 03 00 00 00 0E 00 00 00 04 00 01 02 03 00 00 00 0F 00 00 00 02 00 01 00 00 00 10 00 00 00 02 00 01 00 00 00 11 00 00 00 02 00 01 00 00 00 12 00 00 00 01 00 00 00 00 13 00 00 00 01 00 00 00 00 14 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 05 00 00 00 06 00 00 00 07 00 00 00 08 00 00 00 09 00 00 00 0A 00 00 00 0B 00 00 00 0C 00 00 00 0D 00 00 00 0E 00 00 00 0F 00 00 00 10 00 00 00 11 00 00 00 12 00 00 00 13 00 00 00 14 00 00 00 00 00 00 00 02 00 00 00 01 00 00 00 02 00 00 00 02 00 00 00 02 00 00 00 03 00 00 00 01 00 00 00 04 00 00 00 01 00 00 00 05 00 00 00 01 00 00 00 06 00 00 00 01 00 00 00 07 00 00 00 01 00 00 00 08 00 00 00 00 00 00 00 09 00 00 00 01 00 00 00 0A 00 00 00 01 00 00 00 0B 00 00 00 01 00 00 00 0C 00 00 00 01 00 00 00 0D 00 00 00 00 00 00 00 0E 00 00 00 00 00 00 00 0F 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 11 00 00 00 00 00 00 00 12 00 00 00 00 00 00 00 13 00 00 00 00 00 00 00 14 00 00 00 00 00 01 83 3F 00 00 00 01 00 01 83 40 00 00 00 02 00 01 83 41 00 00 00 03 00 01 83 42 00 00 00 04 00 01 83 43 00 00 00 05 00 01 83 44 00 00 00 06 00 01 83 45 00 00 00 07 00 01 83 46 00 00 00 08 00 01 83 47 00 00 00 09 00 01 83 48 00 00 00 0A 00 01 83 49 00 00 00 0B 00 01 83 4A 00 00 00 0C 00 01 83 4B 00 00 00 0D 00 01 83 4C 00 00 00 0E 00 01 83 4D 00 00 00 0F 00 01 83 4E 00 00 00 10 00 01 83 4F 00 00 00 11 00 01 E3 32 00 00 00 12 00 01 E4 47 00 00 00 13 00 01 E4 47 00 00 00 4A 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 05 00 00 00 06 00 00 00 07 00 00 00 08 00 00 00 09 00 00 00 0A 00 00 00 0B 00 00 00 0C 00 00 00 0D 00 00 00 0E 00 00 00 0F 00 00 00 10 00 00 00 11 00 00 00 12 00 00 00 13 00 00 00 14 00 00 00 15 00 00 00 16 00 00 00 17 00 00 00 18 00 00 00 19 00 00 00 1A 00 00 00 1B 00 00 00 1C 00 00 00 1D 00 00 00 1E 00 00 00 1F 00 00 00 20 00 00 00 21 00 00 00 22 00 00 00 23 00 00 00 24 00 00 00 25 00 00 00 26 00 00 00 27 00 00 00 28 00 00 00 29 00 00 00 2A 00 00 00 2B 00 00 00 2C 00 00 00 2D 00 00 00 2E 00 00 00 2F 00 00 00 30 00 00 00 31 00 00 00 32 00 00 00 33 00 00 00 34 00 00 00 35 00 00 00 36 00 00 00 3A 00 00 00 3B 00 00 00 3C 00 00 00 3D 00 00 00 3E 00 00 00 3F 00 00 00 40 00 00 00 41 00 00 00 42 00 00 00 43 00 00 00 44 00 00 00 45 00 00 00 46 00 00 00 47 00 00 00 48 00 00 00 49 00 00 00 4A 00 00 00 4E 00 00 00 4F 00 00 00 02 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 13 00 00 00 00");

            client.SendPacket(p, true);
        }


        public static void SendChannelNews(Client client, Packet packet)
        {
            Packet p = new Packet((short)LoginOpcodes.ENU_CHANNEL_NEWS_NOT);
            p.WriteHexString("00 00 00 00");
            client.SendPacket(p, false);
        }

        public static void SendSocketTableInfo(Client client, Packet packet)
        {
            Packet p = new Packet((short)LoginOpcodes.ENU_SOCKET_TABLE_INFO_NOT);
            p.WriteHexString("00 00 00 65 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 01 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 02 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 03 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 05 00 00 00 04 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 05 00 00 00 05 00 00 00 02 00 00 00 03 00 00 00 04 00 00 00 05 00 00 00 06 00 00 00 03 00 00 00 04 00 00 00 05 00 00 00 06 00 00 00 07 00 00 00 03 00 00 00 04 00 00 00 05 00 00 00 06 00 00 00 08 00 00 00 03 00 00 00 04 00 00 00 05 00 00 00 06 00 00 00 09 00 00 00 04 00 00 00 05 00 00 00 06 00 00 00 07 00 00 00 0A 00 00 00 04 00 00 00 05 00 00 00 06 00 00 00 07 00 00 00 0B 00 00 00 04 00 00 00 05 00 00 00 06 00 00 00 07 00 00 00 0C 00 00 00 05 00 00 00 06 00 00 00 07 00 00 00 08 00 00 00 0D 00 00 00 05 00 00 00 06 00 00 00 07 00 00 00 08 00 00 00 0E 00 00 00 05 00 00 00 06 00 00 00 07 00 00 00 08 00 00 00 0F 00 00 00 06 00 00 00 07 00 00 00 08 00 00 00 09 00 00 00 10 00 00 00 06 00 00 00 07 00 00 00 08 00 00 00 09 00 00 00 11 00 00 00 06 00 00 00 07 00 00 00 08 00 00 00 09 00 00 00 12 00 00 00 07 00 00 00 08 00 00 00 09 00 00 00 0A 00 00 00 13 00 00 00 07 00 00 00 08 00 00 00 09 00 00 00 0A 00 00 00 14 00 00 00 07 00 00 00 08 00 00 00 09 00 00 00 0A 00 00 00 15 00 00 00 08 00 00 00 09 00 00 00 0A 00 00 00 0B 00 00 00 16 00 00 00 08 00 00 00 09 00 00 00 0A 00 00 00 0B 00 00 00 17 00 00 00 08 00 00 00 09 00 00 00 0A 00 00 00 0B 00 00 00 18 00 00 00 09 00 00 00 0A 00 00 00 0B 00 00 00 0C 00 00 00 19 00 00 00 09 00 00 00 0A 00 00 00 0B 00 00 00 0C 00 00 00 1A 00 00 00 09 00 00 00 0A 00 00 00 0B 00 00 00 0C 00 00 00 1B 00 00 00 0A 00 00 00 0B 00 00 00 0C 00 00 00 0D 00 00 00 1C 00 00 00 0A 00 00 00 0B 00 00 00 0C 00 00 00 0D 00 00 00 1D 00 00 00 0A 00 00 00 0B 00 00 00 0C 00 00 00 0D 00 00 00 1E 00 00 00 0B 00 00 00 0C 00 00 00 0D 00 00 00 0E 00 00 00 1F 00 00 00 0B 00 00 00 0C 00 00 00 0D 00 00 00 0E 00 00 00 20 00 00 00 0B 00 00 00 0C 00 00 00 0D 00 00 00 0E 00 00 00 21 00 00 00 0C 00 00 00 0D 00 00 00 0E 00 00 00 0F 00 00 00 22 00 00 00 0C 00 00 00 0D 00 00 00 0E 00 00 00 0F 00 00 00 23 00 00 00 0C 00 00 00 0D 00 00 00 0E 00 00 00 0F 00 00 00 24 00 00 00 0D 00 00 00 0E 00 00 00 0F 00 00 00 10 00 00 00 25 00 00 00 0D 00 00 00 0E 00 00 00 0F 00 00 00 10 00 00 00 26 00 00 00 0D 00 00 00 0E 00 00 00 0F 00 00 00 10 00 00 00 27 00 00 00 0E 00 00 00 0F 00 00 00 10 00 00 00 11 00 00 00 28 00 00 00 0E 00 00 00 0F 00 00 00 10 00 00 00 11 00 00 00 29 00 00 00 0E 00 00 00 0F 00 00 00 10 00 00 00 11 00 00 00 2A 00 00 00 0F 00 00 00 10 00 00 00 11 00 00 00 12 00 00 00 2B 00 00 00 0F 00 00 00 10 00 00 00 11 00 00 00 12 00 00 00 2C 00 00 00 0F 00 00 00 10 00 00 00 11 00 00 00 12 00 00 00 2D 00 00 00 10 00 00 00 11 00 00 00 12 00 00 00 13 00 00 00 2E 00 00 00 10 00 00 00 11 00 00 00 12 00 00 00 13 00 00 00 2F 00 00 00 10 00 00 00 11 00 00 00 12 00 00 00 13 00 00 00 30 00 00 00 11 00 00 00 12 00 00 00 13 00 00 00 14 00 00 00 31 00 00 00 11 00 00 00 12 00 00 00 13 00 00 00 14 00 00 00 32 00 00 00 11 00 00 00 12 00 00 00 13 00 00 00 14 00 00 00 33 00 00 00 12 00 00 00 13 00 00 00 14 00 00 00 15 00 00 00 34 00 00 00 12 00 00 00 13 00 00 00 14 00 00 00 15 00 00 00 35 00 00 00 12 00 00 00 13 00 00 00 14 00 00 00 15 00 00 00 36 00 00 00 13 00 00 00 14 00 00 00 15 00 00 00 16 00 00 00 37 00 00 00 13 00 00 00 14 00 00 00 15 00 00 00 16 00 00 00 38 00 00 00 13 00 00 00 14 00 00 00 15 00 00 00 16 00 00 00 39 00 00 00 14 00 00 00 15 00 00 00 16 00 00 00 17 00 00 00 3A 00 00 00 14 00 00 00 15 00 00 00 16 00 00 00 17 00 00 00 3B 00 00 00 14 00 00 00 15 00 00 00 16 00 00 00 17 00 00 00 3C 00 00 00 15 00 00 00 16 00 00 00 17 00 00 00 18 00 00 00 3D 00 00 00 15 00 00 00 16 00 00 00 17 00 00 00 18 00 00 00 3E 00 00 00 15 00 00 00 16 00 00 00 17 00 00 00 18 00 00 00 3F 00 00 00 16 00 00 00 17 00 00 00 18 00 00 00 19 00 00 00 40 00 00 00 16 00 00 00 17 00 00 00 18 00 00 00 19 00 00 00 41 00 00 00 16 00 00 00 17 00 00 00 18 00 00 00 19 00 00 00 42 00 00 00 17 00 00 00 18 00 00 00 19 00 00 00 1A 00 00 00 43 00 00 00 17 00 00 00 18 00 00 00 19 00 00 00 1A 00 00 00 44 00 00 00 17 00 00 00 18 00 00 00 19 00 00 00 1A 00 00 00 45 00 00 00 18 00 00 00 19 00 00 00 1A 00 00 00 1B 00 00 00 46 00 00 00 18 00 00 00 19 00 00 00 1A 00 00 00 1B 00 00 00 47 00 00 00 18 00 00 00 19 00 00 00 1A 00 00 00 1B 00 00 00 48 00 00 00 19 00 00 00 1A 00 00 00 1B 00 00 00 1C 00 00 00 49 00 00 00 19 00 00 00 1A 00 00 00 1B 00 00 00 1C 00 00 00 4A 00 00 00 19 00 00 00 1A 00 00 00 1B 00 00 00 1C 00 00 00 4B 00 00 00 1A 00 00 00 1B 00 00 00 1C 00 00 00 1D 00 00 00 4C 00 00 00 1A 00 00 00 1B 00 00 00 1C 00 00 00 1D 00 00 00 4D 00 00 00 1A 00 00 00 1B 00 00 00 1C 00 00 00 1D 00 00 00 4E 00 00 00 1B 00 00 00 1C 00 00 00 1D 00 00 00 1E 00 00 00 4F 00 00 00 1B 00 00 00 1C 00 00 00 1D 00 00 00 1E 00 00 00 50 00 00 00 1B 00 00 00 1C 00 00 00 1D 00 00 00 1E 00 00 00 51 00 00 00 1C 00 00 00 1D 00 00 00 1E 00 00 00 1F 00 00 00 52 00 00 00 1C 00 00 00 1D 00 00 00 1E 00 00 00 1F 00 00 00 53 00 00 00 1C 00 00 00 1D 00 00 00 1E 00 00 00 1F 00 00 00 54 00 00 00 1D 00 00 00 1E 00 00 00 1F 00 00 00 20 00 00 00 55 00 00 00 1D 00 00 00 1E 00 00 00 1F 00 00 00 20 00 00 00 56 00 00 00 1D 00 00 00 1E 00 00 00 1F 00 00 00 20 00 00 00 57 00 00 00 1E 00 00 00 1F 00 00 00 20 00 00 00 21 00 00 00 58 00 00 00 1E 00 00 00 1F 00 00 00 20 00 00 00 21 00 00 00 59 00 00 00 1E 00 00 00 1F 00 00 00 20 00 00 00 21 00 00 00 5A 00 00 00 1F 00 00 00 20 00 00 00 21 00 00 00 22 00 00 00 5B 00 00 00 1F 00 00 00 20 00 00 00 21 00 00 00 22 00 00 00 5C 00 00 00 1F 00 00 00 20 00 00 00 21 00 00 00 22 00 00 00 5D 00 00 00 20 00 00 00 21 00 00 00 22 00 00 00 23 00 00 00 5E 00 00 00 20 00 00 00 21 00 00 00 22 00 00 00 23 00 00 00 5F 00 00 00 20 00 00 00 21 00 00 00 22 00 00 00 23 00 00 00 60 00 00 00 21 00 00 00 22 00 00 00 23 00 00 00 24 00 00 00 61 00 00 00 21 00 00 00 22 00 00 00 23 00 00 00 24 00 00 00 62 00 00 00 21 00 00 00 22 00 00 00 23 00 00 00 24 00 00 00 63 00 00 00 22 00 00 00 23 00 00 00 24 00 00 00 25 00 00 00 64 00 00 00 22 00 00 00 23 00 00 00 24 00 00 00 25 00 00 00 65 00 00 00 00 00 00 00 BE 00 00 00 FA 00 00 01 4A 00 00 01 D6 00 00 00 01 00 00 00 BE 00 00 00 FA 00 00 01 4A 00 00 01 D6 00 00 00 02 00 00 00 BE 00 00 00 FA 00 00 01 4A 00 00 01 D6 00 00 00 03 00 00 00 FA 00 00 01 4A 00 00 01 D6 00 00 03 52 00 00 00 04 00 00 00 FA 00 00 01 4A 00 00 01 D6 00 00 03 52 00 00 00 05 00 00 00 FA 00 00 01 4A 00 00 01 D6 00 00 03 52 00 00 00 06 00 00 01 4A 00 00 01 D6 00 00 03 52 00 00 08 98 00 00 00 07 00 00 01 4A 00 00 01 D6 00 00 03 52 00 00 08 98 00 00 00 08 00 00 01 4A 00 00 01 D6 00 00 03 52 00 00 08 98 00 00 00 09 00 00 01 D6 00 00 03 52 00 00 08 98 00 00 0E 74 00 00 00 0A 00 00 01 D6 00 00 03 52 00 00 08 98 00 00 0E 74 00 00 00 0B 00 00 01 D6 00 00 03 52 00 00 08 98 00 00 0E 74 00 00 00 0C 00 00 03 52 00 00 08 98 00 00 0E 74 00 00 17 0C 00 00 00 0D 00 00 03 52 00 00 08 98 00 00 0E 74 00 00 17 0C 00 00 00 0E 00 00 03 52 00 00 08 98 00 00 0E 74 00 00 17 0C 00 00 00 0F 00 00 08 98 00 00 0E 74 00 00 17 0C 00 00 22 C4 00 00 00 10 00 00 08 98 00 00 0E 74 00 00 17 0C 00 00 22 C4 00 00 00 11 00 00 08 98 00 00 0E 74 00 00 17 0C 00 00 22 C4 00 00 00 12 00 00 0E 74 00 00 17 0C 00 00 22 C4 00 00 31 9C 00 00 00 13 00 00 0E 74 00 00 17 0C 00 00 22 C4 00 00 31 9C 00 00 00 14 00 00 0E 74 00 00 17 0C 00 00 22 C4 00 00 31 9C 00 00 00 15 00 00 17 0C 00 00 22 C4 00 00 31 9C 00 00 55 F0 00 00 00 16 00 00 17 0C 00 00 22 C4 00 00 31 9C 00 00 55 F0 00 00 00 17 00 00 17 0C 00 00 22 C4 00 00 31 9C 00 00 55 F0 00 00 00 18 00 00 22 C4 00 00 31 9C 00 00 55 F0 00 00 6C 98 00 00 00 19 00 00 22 C4 00 00 31 9C 00 00 55 F0 00 00 6C 98 00 00 00 1A 00 00 22 C4 00 00 31 9C 00 00 55 F0 00 00 6C 98 00 00 00 1B 00 00 31 9C 00 00 55 F0 00 00 6C 98 00 00 84 08 00 00 00 1C 00 00 31 9C 00 00 55 F0 00 00 6C 98 00 00 84 08 00 00 00 1D 00 00 31 9C 00 00 55 F0 00 00 6C 98 00 00 84 08 00 00 00 1E 00 00 55 F0 00 00 6C 98 00 00 84 08 00 00 9C 40 00 00 00 1F 00 00 55 F0 00 00 6C 98 00 00 84 08 00 00 9C 40 00 00 00 20 00 00 55 F0 00 00 6C 98 00 00 84 08 00 00 9C 40 00 00 00 21 00 00 6C 98 00 00 84 08 00 00 9C 40 00 00 B9 28 00 00 00 22 00 00 6C 98 00 00 84 08 00 00 9C 40 00 00 B9 28 00 00 00 23 00 00 6C 98 00 00 84 08 00 00 9C 40 00 00 B9 28 00 00 00 24 00 00 84 08 00 00 9C 40 00 00 B9 28 00 00 D8 CC 00 00 00 25 00 00 84 08 00 00 9C 40 00 00 B9 28 00 00 D8 CC 00 00 00 26 00 00 84 08 00 00 9C 40 00 00 B9 28 00 00 D8 CC 00 00 00 27 00 00 9C 40 00 00 B9 28 00 00 D8 CC 00 00 F8 70 00 00 00 28 00 00 9C 40 00 00 B9 28 00 00 D8 CC 00 00 F8 70 00 00 00 29 00 00 9C 40 00 00 B9 28 00 00 D8 CC 00 00 F8 70 00 00 00 2A 00 00 B9 28 00 00 D8 CC 00 00 F8 70 00 01 1D 28 00 00 00 2B 00 00 B9 28 00 00 D8 CC 00 00 F8 70 00 01 1D 28 00 00 00 2C 00 00 B9 28 00 00 D8 CC 00 00 F8 70 00 01 1D 28 00 00 00 2D 00 00 D8 CC 00 00 F8 70 00 01 1D 28 00 01 47 58 00 00 00 2E 00 00 D8 CC 00 00 F8 70 00 01 1D 28 00 01 47 58 00 00 00 2F 00 00 D8 CC 00 00 F8 70 00 01 1D 28 00 01 47 58 00 00 00 30 00 00 F8 70 00 01 1D 28 00 01 47 58 00 01 7D 40 00 00 00 31 00 00 F8 70 00 01 1D 28 00 01 47 58 00 01 7D 40 00 00 00 32 00 00 F8 70 00 01 1D 28 00 01 47 58 00 01 7D 40 00 00 00 33 00 01 1D 28 00 01 47 58 00 01 7D 40 00 01 B7 74 00 00 00 34 00 01 1D 28 00 01 47 58 00 01 7D 40 00 01 B7 74 00 00 00 35 00 01 1D 28 00 01 47 58 00 01 7D 40 00 01 B7 74 00 00 00 36 00 01 47 58 00 01 7D 40 00 01 B7 74 00 02 00 E4 00 00 00 37 00 01 47 58 00 01 7D 40 00 01 B7 74 00 02 00 E4 00 00 00 38 00 01 47 58 00 01 7D 40 00 01 B7 74 00 02 00 E4 00 00 00 39 00 01 7D 40 00 01 B7 74 00 02 00 E4 00 02 50 F8 00 00 00 3A 00 01 7D 40 00 01 B7 74 00 02 00 E4 00 02 50 F8 00 00 00 3B 00 01 7D 40 00 01 B7 74 00 02 00 E4 00 02 50 F8 00 00 00 3C 00 01 B7 74 00 02 00 E4 00 02 50 F8 00 02 AC C4 00 00 00 3D 00 01 B7 74 00 02 00 E4 00 02 50 F8 00 02 AC C4 00 00 00 3E 00 01 B7 74 00 02 00 E4 00 02 50 F8 00 02 AC C4 00 00 00 3F 00 02 00 E4 00 02 50 F8 00 02 AC C4 00 03 15 10 00 00 00 40 00 02 00 E4 00 02 50 F8 00 02 AC C4 00 03 15 10 00 00 00 41 00 02 00 E4 00 02 50 F8 00 02 AC C4 00 03 15 10 00 00 00 42 00 02 50 F8 00 02 AC C4 00 03 15 10 00 03 BB 78 00 00 00 43 00 02 50 F8 00 02 AC C4 00 03 15 10 00 03 BB 78 00 00 00 44 00 02 50 F8 00 02 AC C4 00 03 15 10 00 03 BB 78 00 00 00 45 00 02 AC C4 00 03 15 10 00 03 BB 78 00 04 27 48 00 00 00 46 00 02 AC C4 00 03 15 10 00 03 BB 78 00 04 27 48 00 00 00 47 00 02 AC C4 00 03 15 10 00 03 BB 78 00 04 27 48 00 00 00 48 00 03 15 10 00 03 BB 78 00 04 27 48 00 04 AC E0 00 00 00 49 00 03 15 10 00 03 BB 78 00 04 27 48 00 04 AC E0 00 00 00 4A 00 03 15 10 00 03 BB 78 00 04 27 48 00 04 AC E0 00 00 00 4B 00 03 BB 78 00 04 27 48 00 04 AC E0 00 05 32 78 00 00 00 4C 00 03 BB 78 00 04 27 48 00 04 AC E0 00 05 32 78 00 00 00 4D 00 03 BB 78 00 04 27 48 00 04 AC E0 00 05 32 78 00 00 00 4E 00 04 27 48 00 04 AC E0 00 05 32 78 00 05 B8 10 00 00 00 4F 00 04 27 48 00 04 AC E0 00 05 32 78 00 05 B8 10 00 00 00 50 00 04 27 48 00 04 AC E0 00 05 32 78 00 05 B8 10 00 00 00 51 00 04 AC E0 00 05 32 78 00 05 B8 10 00 06 3D A8 00 00 00 52 00 04 AC E0 00 05 32 78 00 05 B8 10 00 06 3D A8 00 00 00 53 00 04 AC E0 00 05 32 78 00 05 B8 10 00 06 3D A8 00 00 00 54 00 05 32 78 00 05 B8 10 00 06 3D A8 00 06 C3 40 00 00 00 55 00 05 32 78 00 05 B8 10 00 06 3D A8 00 06 C3 40 00 00 00 56 00 05 32 78 00 05 B8 10 00 06 3D A8 00 06 C3 40 00 00 00 57 00 05 B8 10 00 06 3D A8 00 06 C3 40 00 07 48 74 00 00 00 58 00 05 B8 10 00 06 3D A8 00 06 C3 40 00 07 48 74 00 00 00 59 00 05 B8 10 00 06 3D A8 00 06 C3 40 00 07 48 74 00 00 00 5A 00 06 3D A8 00 06 C3 40 00 07 48 74 00 07 CE 0C 00 00 00 5B 00 06 3D A8 00 06 C3 40 00 07 48 74 00 07 CE 0C 00 00 00 5C 00 06 3D A8 00 06 C3 40 00 07 48 74 00 07 CE 0C 00 00 00 5D 00 06 C3 40 00 07 48 74 00 07 CE 0C 00 08 53 A4 00 00 00 5E 00 06 C3 40 00 07 48 74 00 07 CE 0C 00 08 53 A4 00 00 00 5F 00 06 C3 40 00 07 48 74 00 07 CE 0C 00 08 53 A4 00 00 00 60 00 07 48 74 00 07 CE 0C 00 08 53 A4 00 08 D9 3C 00 00 00 61 00 07 48 74 00 07 CE 0C 00 08 53 A4 00 08 D9 3C 00 00 00 62 00 07 48 74 00 07 CE 0C 00 08 53 A4 00 08 D9 3C 00 00 00 63 00 07 CE 0C 00 08 53 A4 00 08 D9 3C 00 09 5E D4 00 00 00 64 00 07 CE 0C 00 08 53 A4 00 08 D9 3C 00 09 5E D4 00 04 61 54");
            client.SendPacket(p, true);
        }

        public static void SendCashbackRatioInfo(Client client, Packet packet)
        {
            Packet p = new Packet((short)LoginOpcodes.ENU_CASHBACK_RATIO_INFO_NOT);
            p.WriteHexString("00 00 00 00 00 00 00 00");
            client.SendPacket(p, true);
        }

        public static void SendItemBuyInfo(Client client, Packet packet)
        {
            Packet p = new Packet((short)LoginOpcodes.ENU_ITEM_BUY_INFO_NOT);

            p.Write(0);
            
            // TODO: get startid and endid

            p.WriteInt(0);

            client.SendPacket(p, true);
        }

        [OpcodeAttribute((short)LoginOpcodes.ENU_GUIDE_BOOK_LIST_REQ)]
        public static void SendGuideBookList(Client client, Packet packet)
        {
            Packet p = new Packet((short)LoginOpcodes.ENU_GUIDE_BOOK_LIST_ACK);
            p.WriteHexString("00 00 00 01 00 00 00 00");
            client.SendPacket(p, true);
        }

        [OpcodeAttribute((short)LoginOpcodes.ENU_CLIENT_PING_CONFIG_REQ)]
        public static void SendClientPingConfig(Client client, Packet packet)
        {
            Packet p = new Packet((short)LoginOpcodes.ENU_CLIENT_PING_CONFIG_ACK);
            p.WriteHexString("00 00 0F A0 00 00 0F A0 00 00 0F A0 00 00 00 01 00 FF FF FF FF 00 00 00 00");
            client.SendPacket(p, false);
        }
    }
}
